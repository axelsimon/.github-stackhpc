---
name: Tox Workflow
'on':
  workflow_call:
jobs:
  tox:
      runs-on: ubuntu-20.04
      strategy:
        matrix:
          include:
            - environment: py36
              python-version: 3.6
            - environment: py38
              python-version: 3.8
            - environment: pep8
              python-version: 3.8
      name: Tox ${{ matrix.environment }} with Python ${{ matrix.python-version }}
      steps:
        - name: Github Checkout 🛎
          uses: actions/checkout@v3
        - name: Setup Python ${{ matrix.python-version }} 🐍
          uses: actions/setup-python@v4
          with:
            python-version: ${{ matrix.python-version }}
        - name: Install bindep 📦
          run: |
            if [[ -f bindep.txt ]]; then
                pip install bindep
            else
                echo "No bindep.txt"
            fi
        - name: Install missing packages 📦
          run: |
            if [[ -f bindep.txt ]]; then
                sudo apt install $(bindep -b test)
            else
                echo "No bindep.txt"
            fi
        - name: Install Tox 📦
          run: pip install tox==3.*
        - name: Run Tox ${{ matrix.environment }} 🧪
          run: tox -e ${{ matrix.environment }}
